/* Professional tree animations */
@keyframes expandNode {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    50% {
        transform: scale(1.02);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

@keyframes fadeInChildren {
    0% {
        opacity: 0;
        transform: translateY(-4px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes rotateExpander {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(90deg);
    }
}

@keyframes subtleGlow {
    0% {
        box-shadow: 0 0 0 0 transparent;
    }
    50% {
        box-shadow: 0 0 8px 0 rgba(var(--color-primary-rgb, 30, 102, 245), 0.15);
    }
    100% {
        box-shadow: 0 0 0 0 transparent;
    }
}

/* Tree-specific variables */
:root {
    --wb-row-height: 24px;
    --wb-indent-size: 18px;
    --wb-icon-size: 14px;
    --wb-border-radius: 4px;
    --wb-transition-duration: 0.2s;
    --wb-transition-easing: cubic-bezier(0.4, 0, 0.2, 1);
    --wb-hover-bg-opacity: 0.08;
    --wb-active-bg-opacity: 0.12;
    --wb-focus-outline-width: 2px;
    --wb-shadow-subtle: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
}

.wb-row {
    display: flex;
    align-items: center;
    height: var(--wb-row-height);
    line-height: var(--wb-row-height);
    padding: 0 8px;
    cursor: pointer;
    overflow: hidden;
    font-size: 13px;
    font-weight: 400;
    color: var(--color-base-content);
    background-color: transparent;
    border-radius: var(--wb-border-radius);
    margin: 0 4px;
    transition: all var(--wb-transition-duration) var(--wb-transition-easing);
    position: relative;
    user-select: none;
}

.wb-row:hover {
    background-color: color-mix(in srgb, var(--color-base-content) var(--wb-hover-bg-opacity), transparent);
    transform: translateX(2px);
}

.wb-row.wb-active {
    background-color: var(--color-primary);
    color: var(--color-primary-content);
    font-weight: 500;
    box-shadow: var(--wb-shadow-subtle);
}

.wb-row.wb-active:hover {
    background-color: color-mix(in srgb, var(--color-primary) 90%, white 10%);
}

.wb-row.wb-focus {
    outline: var(--wb-focus-outline-width) solid var(--color-primary);
    outline-offset: -1px;
    background-color: color-mix(in srgb, var(--color-primary) var(--wb-active-bg-opacity), transparent);
}

.wb-row.wb-expanded {
    animation: expandNode var(--wb-transition-duration) var(--wb-transition-easing);
}

/* Smooth child reveal animation */
.wb-row[data-wb-level] {
    animation: fadeInChildren 0.3s var(--wb-transition-easing) forwards;
    opacity: 0;
}

.wb-row[data-wb-level="0"] {
    animation-delay: 0ms;
}

.wb-row[data-wb-level="1"] {
    animation-delay: 50ms;
}

.wb-row[data-wb-level="2"] {
    animation-delay: 100ms;
}

.wb-row[data-wb-level="3"] {
    animation-delay: 150ms;
}

.wb-expander {
    width: var(--wb-icon-size);
    height: var(--wb-icon-size);
    margin-right: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    color: var(--color-base-content);
    opacity: 0.7;
    transition: all var(--wb-transition-duration) var(--wb-transition-easing);
    border-radius: 2px;
}

.wb-expander:hover {
    opacity: 1;
    background-color: color-mix(in srgb, var(--color-base-content) 0.1, transparent);
}

.wb-expanded > .wb-node > .wb-expander {
    transform: rotate(90deg);
    color: var(--color-primary);
    opacity: 1;
}

.wb-row.wb-active .wb-expander {
    color: var(--color-primary-content);
    opacity: 1;
}

.wb-icon {
    width: var(--wb-icon-size);
    height: var(--wb-icon-size);
    margin-right: 6px;
    flex-shrink: 0;
    opacity: 0.8;
    transition: all var(--wb-transition-duration) var(--wb-transition-easing);
}

.wb-row:hover .wb-icon {
    opacity: 1;
}

.wb-row.wb-active .wb-icon {
    opacity: 1;
}

.wb-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
    min-width: 0;
    font-size: inherit;
    font-weight: inherit;
    transition: all var(--wb-transition-duration) var(--wb-transition-easing);
}

.wb-expanded > .wb-node > .wb-title {
    font-weight: 500;
}

.wb-indent {
    display: inline-block;
    width: var(--wb-indent-size);
    flex-shrink: 0;
    position: relative;
}

.wb-node {
    display: flex;
    align-items: center;
    width: 100%;
    transition: all var(--wb-transition-duration) var(--wb-transition-easing);
}

/* Subtle indent guidelines */
.wb-indent::before {
    content: "";
    position: absolute;
    left: 50%;
    top: -12px;
    bottom: -12px;
    width: 1px;
    transform: translateX(-50%);
    background-color: var(--color-base-content);
    opacity: 0.15;
    transition: opacity var(--wb-transition-duration) var(--wb-transition-easing);
}

/* Enhanced guidelines for expanded nodes */
.wb-expanded .wb-indent::before {
    opacity: 0.25;
    background: linear-gradient(
        to bottom,
        transparent 0%,
        var(--color-base-content) 20%,
        var(--color-base-content) 80%,
        transparent 100%
    );
}

/* Hide guidelines on hover for cleaner look */
.wb-row:hover .wb-indent::before {
    opacity: 0.1;
}

/* Hide guidelines for leaf nodes */
.wb-indent:last-of-type::before {
    display: none;
}

/* Professional tree container styling */
.wb-tree {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background-color: var(--color-base-100);
    border-radius: var(--wb-border-radius);
    padding: 4px 0;
    overflow: auto;
}

/* Smooth scrollbar styling */
.wb-tree::-webkit-scrollbar {
    width: 8px;
}

.wb-tree::-webkit-scrollbar-track {
    background: var(--color-base-200);
    border-radius: 4px;
}

.wb-tree::-webkit-scrollbar-thumb {
    background: var(--color-base-300);
    border-radius: 4px;
    transition: background-color var(--wb-transition-duration) var(--wb-transition-easing);
}

.wb-tree::-webkit-scrollbar-thumb:hover {
    background: var(--color-neutral);
}

/* Focus management for accessibility */
.wb-tree:focus-within {
    outline: none;
}

/* Keyboard navigation indicators */
.wb-row[tabindex="0"]:focus-visible {
    outline: var(--wb-focus-outline-width) solid var(--color-primary);
    outline-offset: 2px;
    background-color: color-mix(in srgb, var(--color-primary) 0.1, transparent);
}

/* Loading state styling */
.wb-row.wb-loading {
    opacity: 0.6;
    pointer-events: none;
}

.wb-row.wb-loading .wb-title::after {
    content: "...";
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}
